(function(t,u,Ca){function I(a,b){return ia&&ia.dataset[a]||b}function J(){var a=[].reduce.call(arguments,(b,c)=>{if(b[c.length])throw y("Arity dispatch: duplicate function with the same number of arguments",{length:c.length,func:c.length,duplicate:b[c.length]});b[c.length]=c;return b},{});return function c(){var d=arguments.length,e=a[d];if(!e)throw y("No function supplied accepting "+d+" arguments",{functions:a,arguments:Array.from(arguments)});return e.apply({dispatcher:c},arguments)}}function Da(a,
b){return a.reduce(function(c,d){var e=b(d);(c[e]||(c[e]=[])).push(d);return c},{})}function Ea(a,b){return a.map((c,d)=>[c,b[d]])}function Fa(a){for(var b=new Set,c=[],d,e=0;e<a.length;e++)d=a[e],b.has(d)||(b.add(d),c.push(d));return c}function y(a,b){a=Error(a);a.extra=b;return a}function P(a){var b=null;return function(){return b||(b=a())}}function ja(a){if(a=a&&a.trim())return a.match(/\d+s/)?1E3*parseFloat(a):parseFloat(a)}function ka(a){"loading"==u.readyState?u.addEventListener("DOMContentLoaded",
a):a()}function w(a,b,c,d){d=d&&d.hasOwnProperty("bubbles")?d.bubbles:!0;d=new CustomEvent(b,{bubbles:d,cancelable:!0,detail:c});console.debug("\ud83d\udece\ufe0f EVENT",b,{el:a,detail:c});a.dispatchEvent(d);return d}function F(a,b){return 1==a.nodeType&&a.matches(b)?a:a.querySelector?a.querySelector(b):null}function z(a,b){if(!a.querySelectorAll)return[];var c=Array.from(a.querySelectorAll(b));1==a.nodeType&&a.matches(b)&&c.unshift(a);return c}function la(a){if(a.id)return a.id;var b=a.tagName.toLowerCase();
return a.className?b+"."+a.className.replace(" ","."):b}function ma(a,b){var c=[],d=a;do(a=d.getAttribute(b))&&c.push(a);while(d=d.parentElement);return c}function A(a,b,c){a=a["twinspark-internal"]||(a["twinspark-internal"]={});if(!b)return a;a.hasOwnProperty(b)||"undefined"==typeof c||(a[b]=c);return a[b]}function L(a,b){a={selector:a,handler:b};Q.push(a);Z&&z(u.body,a.selector).forEach(a.handler)}function Ga(a){A(a,"event-handlers",[]).forEach(b=>a.removeEventListener(b.type,b.func,b.opts))}function x(a,
b,c,d){a.addEventListener(b,c,d);A(a,"event-handlers",[]).push({type:b,func:c,opts:d});return a}function Ha(a){Ga(a);Q.forEach(b=>a.matches(b.selector)&&b.handler(a))}function M(a){var b=Q.map(c=>c.selector).join(",");z(a,b).forEach(Ha);w(a,"ts-ready")}function Ia(a,b){var c=new XMLHttpRequest;return{promise:new Promise(function(d,e){b||(b={});c.open(b.method||"GET",a,!0);for(var g in b.headers)c.setRequestHeader(g,b.headers[g]);c.onreadystatechange=function(){if(4==c.readyState&&0!=c.status){var l=
{"ts-title":c.getResponseHeader("ts-title"),"ts-history":c.getResponseHeader("ts-history"),"ts-swap":c.getResponseHeader("ts-swap"),"ts-swap-push":c.getResponseHeader("ts-swap-push")};return d({ok:200<=c.status&&299>=c.status,status:c.status,url:c.responseURL,reqUrl:a,xhr:c,opts:b,headers:l,content:c.responseText})}};c.timeout=Ja;c.ontimeout=function(){return e({ok:!1,status:0,url:a,error:"timeout"})};c.send(b.body)}),xhr:c}}function K(a,b,c){if(!b)return a;var d,e;for([d,e]of b)d&&(!c||null!==e&&
""!==e?a.append(d,e):a.delete(d));return a}function Ka(a,b){return ma(a,b).reduceRight((c,d)=>{if(""==d)var e=null;else if("{"==d[0])if(d=JSON.parse(d),"object"===typeof d&&null!==d){var g=[];for(e in d)g.push([e,d[e]]);e=g}else e=void 0;else e=K(new FormData,new URLSearchParams(d));return K(c,e,!0)},new FormData)}function aa(a){return a.name&&"submit"!=a.type&&("radio"!=a.type&&"checkbox"!=a.type||a.checked)?a.value:null}function na(a,b){var c=Ka(a,"ts-data"),d=a.tagName,e;"FORM"==d?(b&&b.submitter&&
b.submitter.name&&b.submitter.value&&c.append(b.submitter.name,b.submitter.value),c=K(c,new FormData(a))):("INPUT"==d||"SELECT"==d||"TEXTAREA"==d)&&(e=aa(a))&&c.append(a.name,e);return c}function R(a){return new Promise(function(b,c){a.onsuccess=function(){b(a.result)};a.onerror=function(){c(a.error)}})}function oa(){if(ba)return ba;var a=La.open("twinspark",1);a.onupgradeneeded=function(){a.result.createObjectStore("twinspark",{keyPath:"url"}).createIndex("time","time")};return ba=R(a)}function S(a,
b){return a.transaction(a.name,b&&b.write&&"readwrite"||"readonly").objectStore(a.name)}async function Ma(a){var b=S(a);b=await R(b.count());console.debug("PAGES IN STORAGE",b);var c=b-Na;if(!(0>=c)){b=S(a,{write:!0});var d=b.index("time").openCursor();d.onsuccess=function(e){if(e=d.result)e.delete(),0<--c&&e.continue()}}}async function pa(){var a={url:G.pathname+G.search,html:u.body.innerHTML,time:+new Date},b=await oa(),c=S(b,{write:!0});await R(c.put(a));await Ma(b)}function Oa(a,b){pa();history.replaceState("history",
"","");history.pushState(null,b,a);w(t,"ts-pushstate",{url:a})}function Pa(a){history.replaceState("history","",a);w(t,"ts-replacestate",{url:a})}async function qa(a){if(a.state){var b=G.pathname+G.search,c=await oa();c=S(c);b=await R(c.get(b));console.debug("onpopstate restore",b.url,b.html.length,b.time);b&&b.html&&(u.body.innerHTML=b.html,("INITIAL"!=a.state||Z)&&M(u.body))}}function B(a,b){if(!a)return a;null==b&&(b=a.getAttribute("ts-target"));return b?b.split("|").map(c=>c.trim()).reduce((c,
d,e)=>{e=0<e;if(d&&c&&"target"!=d)if("inherit"==d){var g=c.parentElement.closest("[ts-target]");g=B(g)}else g="parent "==d.slice(0,7)?c.closest(d.slice(7)):"child "==d.slice(0,6)?c.querySelector(d.slice(6)):"sibling "==d.slice(0,8)?c.parentElement.querySelector(d.slice(8)):e?c.querySelector(d):u.querySelector(d);else g=c;if(!g)throw c=c.outerHTML.match(/<.+?>/)[0],y(`Could not find element with selector ${d} for element ${c}`+(e?" among children":""),{element:c,selector:d});return g},a):a}function C(a,
b,c,d){var e=b.getAttribute(c);e!=a.getAttribute(c)&&(d&&(a[c]=b[c]||""),e?a.setAttribute(c,e):a.removeAttribute(c))}function ra(a,b){for(var c of Qa)C(a,b,c)}function sa(a){a.classList.add(ta);setTimeout(()=>a.classList.remove(ta))}function Ra(a,b,c){if(a.id){b=b.querySelector(a.tagName+"[id='"+a.id+"']");if(!b)return sa(a);var d=a.cloneNode();ra(a,b);c.tasks.push(function(){ra(a,d)});return c}}function ca(a,b,c,d){a||(a="replace");"morph"!=a&&"morph-all"!=a&&"skip"!=a&&z(c,"[id]").forEach(function(e){Ra(e,
b,d)});switch(a){case "morph-all":c=da(b,c,{ignoreActive:!1});break;case "morph":c=da(b,c,{ignoreActive:!0});break;case "replace":b.replaceWith(c);break;case "inner":b.replaceChildren(c);break;case "prepend":b.prepend(c);break;case "append":b.append(c);break;case "beforebegin":b.parentNode.insertBefore(c,b);break;case "afterend":b.parentNode.insertBefore(c,b.nextSibling);break;case "skip":break;default:throw Error("Unknown swap strategy "+a);}return c}function ua(a,b,c){var d=B(a);if(!d)throw y(`Target element not found for origin ${a.outerHTML.match(/<.+?>/)[0]}`,
{origin:a,replyParent:b});var e;if(e=a.getAttribute("ts-req-selector"))if("children "==e.slice(0,9)){e=F(b,e.slice(9));var g=new DocumentFragment;e&&e.children&&g.append.apply(g,e.children);e=g}else e=F(b,e);else e="BODY"==b.tagName&&"BODY"!=d.tagName?b.children[0]:b;if(!e)throw c=a.getAttribute("ts-req-selector"),y("Cannot find specified html in response, "+`maybe nothing to select as ${c}`,{sel:c,replyParent:b,origin:a});b=a.getAttribute("ts-swap");if(a){g={response:c.response};var l=w(a,"ts-req-after",
g);T(a,l,a.getAttribute("ts-req-after"),g)}return ca(b,d,e,c)}function Sa(a,b,c){var d={response:c,tasks:[]},e=[],g;"skip"!=c.headers["ts-swap"]&&(e=1==a.length?[ua(a[0],b,d)]:Ea(a,b.children).map(([l,p])=>ua(l,p,d)));a=z(b,"[ts-swap-push]").map(l=>{try{var p=l.getAttribute("ts-swap-push");!p&&l.id&&(p="#"+l.id);var q=F(u.body,p);if(!q)throw y("cannot find target for server-pushed swap",{reply:l});var k=l.getAttribute("ts-swap");return ca(k,q,l,d)}catch(n){console.error(n)}});c.headers["ts-swap-push"]&&
(g=c.headers["ts-swap-push"].split(",").map(l=>{try{var p=l.match(/(\w+):(.+)<=(.+)/);if(!p)throw y("Cannot parse ts-swap-push header value",{header:l});var q=p[1],k=F(u.body,p[2]);if(!k)throw y("cannot find target for header swap",{sel:p[2]});var n=F(b,p[3]);if(!n)throw y("cannot find target for header swap",{reply:n,sel:p[3]});return ca(q,k,n,d)}catch(f){console.error(f)}}));e=e.concat(a).concat(g).filter(l=>l);e=Fa(e);e.forEach(function(l){for(var p=l.querySelectorAll("script"),q=0;q<p.length;q++){var k=
p[q];if(!(k.type&&"text/javascript"!=k.type||k.dataset.tsNoload)){for(var n=k.parentNode,f=u.createElement(k.nodeName),h=0;h<k.attributes.length;h++){var m=k.attributes[h].name,r=k.getAttribute(m);f.setAttribute(m,r)}f.appendChild(u.createTextNode(k.innerHTML));n.replaceChild(f,k)}}M(l);(l=F(l,"[autofocus]"))&&l.focus()});setTimeout(function(){d.tasks.forEach(function(l){l()})},16);return e}function va(a,b,c,d){var e=(new DOMParser).parseFromString(c,"text/html");e.body.querySelectorAll("noscript").forEach(g=>
g.remove());c=d.headers["ts-title"]||e.title;e=e.body;if(e.children.length<b.length&&"skip"!=d.headers["ts-swap"])throw`This request needs at least ${b.length} elements, `+`but ${e.children.length} were returned`;(a=d.headers["ts-history"]||b[0].hasAttribute("ts-req-history")&&a)&&("replace"==b[0].getAttribute("ts-req-history")?Pa(a):Oa(a,c));return Sa(b,e,d)}function Ta(a){let b,c,d;var e=na(a.el,null!=(d=null==(b=a.event)?void 0:null==(c=b.detail)?void 0:c.event)?d:a.event);return{method:a.method,
data:K(e,a.opts.data),headers:{Accept:"text/html+partial","TS-URL":G.pathname+G.search,"TS-Origin":la(a.el),"TS-Target":la(B(a.el))}}}function Ua(a,b){if(!b)return a;if(!Array.from(b.entries).every(c=>"string"===typeof c))return a.body=b,a;b=new URLSearchParams(b);a.body=b.toString();a.headers["Content-Type"]="application/x-www-form-urlencoded";return a}function Va(a){if(a.length){var b=a[0].url,c=a[0].method,d=a.reduce(function(k,n){return K(k,n.opts.data)},new FormData),e="GET"==c?(new URLSearchParams(d)).toString():
null;d="GET"!=c?d:null;var g={method:c,headers:a.reduce(function(k,n){n=n.opts.headers;for(var f in n)k[f]?k[f]!=n[f]&&(k[f]+=", "+n[f]):k[f]=n[f];return k},{})};g=Ua(g,d);var l=b;e&&(l+=-1==b.indexOf("?")?"?":"&",l+=e);var p=a.map(function(k){return k.el}),q=Ia(l,g);p.forEach(function(k){k.setAttribute("aria-busy","true");k.classList.add(Wa);A(k)["active-xhr"]=q.xhr});return q.promise.then(function(k){ea(()=>p.forEach(n=>{n.removeAttribute("aria-busy");n.classList.remove("ts-active");delete A(n)["active-xhr"]}));
if(q.xhr.isAborted)return!1;if(k.ok)return k.url&&k.url!=(new URL(l,G.href)).href?(k.headers["ts-history"]||(k.headers["ts-history"]=k.url),k.swap=va(k.url,[u.body],k.content,k)):k.swap=va(b,p,k.content,k),k;U("Something wrong with response",k.content);p.forEach(function(n){w(n,"ts-req-error",H({error:"ts-req-error"},{response:k,url:l,opts:g}))});return k}).catch(function(k){ea(()=>p.forEach(n=>{n.removeAttribute("aria-busy");n.classList.remove("ts-active");delete A(n)["active-xhr"]}));U("Error retrieving backend response",
l,k.error||k);p.forEach(function(n){w(n,"ts-req-error",H({error:"ts-req-error"},{response:k,url:l,opts:g}))});return k})}}function V(a){a=Array.isArray(a)?a:[a];return Promise.all(a.map(function(b){b.opts=Ta(b);var c={req:b},d=w(b.el,"ts-req-before",c);if(d.defaultPrevented)return null;var e=b;(c=T(b.el,d,b.el.getAttribute("ts-req-before"),c))&&(e=c.then(function(l){return d.defaultPrevented?null:b}));c=b.el.getAttribute("ts-req-strategy")||"queue";var g=A(b.el)["active-xhr"];if("first"===c&&g)return null;
"last"===c&&g&&(g.abort(),delete A(b.el)["active-xhr"]);return e})).then(function(b){return b.filter(function(c){return!!c})}).then(Va)}function Xa(){var a=Da(N.reqs,c=>c.method+c.url);N={reqs:[],request:null};for(var b in a)V(a[b])}function W(a,b,c,d){var e=(null==d?void 0:d.url)||(c?a.getAttribute("ts-req-batch"):a.getAttribute("ts-req"))||("FORM"==a.tagName?a.getAttribute("action"):a.getAttribute("href")),g=((null==d?void 0:d.method)||a.getAttribute("ts-req-method")||("FORM"==a.tagName?a.getAttribute("method")||
"POST":"GET")).toUpperCase();return{el:a,opts:{data:null==d?void 0:d.data},event:b,url:e,method:g,batch:c}}function fa(a,b){var c=a.tagName,d="click";if("FORM"==c)d="submit";else if("INPUT"==c||"SELECT"==c||"TEXTAREA"==c)d="change";var e=null;"FORM"==c&&"submit"==d&&z(a,'button, input[type="submit"]').forEach(g=>{x(g,"click",l=>{e=l.target})});return x(a,d,function(g){g.altKey||g.ctrlKey||g.shiftKey||g.metaKey||0!=(g.button||0)||(g.preventDefault(),g.stopPropagation(),!g.submitter&&e&&"submit"==e.type&&
(g.submitter=e),b(g),e=null)})}function ha(a,b,c){a=t._ts_func&&t._ts_func[a]||O[a]||t[a];if(!a)throw Error("Unknown action command: "+c.src);return a.apply(c.el,b.concat([c]))}function X(a){function b(){var m=p.trim();if(m.length){var r=l,D=r.push;var v=m[0];m='"'==v||"'"==v?m.slice(1,m.length-1):m;D.call(r,m)}p=""}function c(){l.length&&(g.push({src:a.slice(q,n).trim(),name:l[0],args:l.slice(1)}),l=[],q=n+1)}function d(){g.length&&(e.push({src:a.slice(k,n).trim(),commands:g}),g=[],k=n+1)}var e=
[],g=[],l=[],p="",q=0,k=0,n=0,f=null;for(n=0;n<a.length;n++){var h=a[n];if(f)"\\"==h?(n++,p+=a[n]):h==f?(p+=h,f=null):p+=h;else{if("'"==h||'"'==h)f=h;else if(" "==h){b();continue}else if(","==h){b();c();continue}else if(";"==h){b();c();d();continue}p+=h}}b();c();d();return e}function wa(a,b){console.debug("ACTION",a.src,b);var c=H({line:a.src},b);return a.commands.reduce(function(d,e){return d.then(function(g){console.debug(!1!==g?"\ud83d\udd35":"\ud83d\udeab","COMMAND",e.src,{input:g,src:a.src});
if(!1===g)return g;void 0!==g&&(c.input=g);c.command=e.name;c.src=e.src;return ha(e.name,e.args,c)}).catch(function(g){throw H(g,{extra:{command:e.src,action:a.src,element:c.el.outerHTML.match(/<.+?>/)[0]}});})},Promise.resolve(null))}function T(a,b,c,d){if(c){console.debug("ACTIONS",{spec:c,event:b,payload:d});c=X(c);a=H({el:a,event:b},d);var e;for(b=0;b<c.length;b++)d=c[b],d.commands.length&&(e=wa(d,a));return e}}function xa(a){var b=a.on,c=a.off,d=a.threshold;return new IntersectionObserver(function(e,
g){for(g=0;g<e.length;g++){var l=e[g];l.intersectionRatio>d?w(l.target,b,{entry:l}):l.intersectionRatio<d&&w(l.target,c,{entry:l})}},a)}function Ya(a){var b=a.args.indexOf("delay"),c=-1!=a.args.indexOf("changed"),d=-1!=a.args.indexOf("once"),e=-1!=b?ja(a.args[b+1]):null;return function(g,l){function p(){w(g,"ts-trigger",{event:l},{bubbles:!1})}var q=A(g,"trigger",{});if(d){if(q.once)return;q.once=!0}if(c){if(q.value==aa(g))return;q.value=aa(g)}e?(q.delay&&clearTimeout(q.delay),q.delay=setTimeout(p,
e)):p()}}function Y(a,b,c,d){function e(g){c(g);A(a,"trigger",{}).once&&a.removeEventListener(b,e,d)}x(a,b,e,d)}function ya(a,b,c){switch(b){case "load":ea(function(){c(a,{type:"load"})});break;case "windowScroll":Y(t,"scroll",function(d){c(a,d)},{passive:!0});break;case "scroll":Y(a,"scroll",function(d){c(a,d)},{passive:!0});break;case "outside":Y(u,"click",function(d){a.contains(d.target)||c(a,d)},{capture:!0});break;case "remove":Za().observe(a.parentElement,{childList:!0});x(a,b,function(d){c(a,
d)});break;case "empty":case "notempty":case "childrenChange":$a().observe(a,{childList:!0});x(a,b,function(d){c(a,d)});break;case "visible":case "invisible":ab().observe(a);x(a,b,function(d){c(a,d)});break;case "closeby":case "away":bb().observe(a);x(a,b,function(d){c(a,d)});break;default:Y(a,b,function(d){c(a,d)})}}function za(a){t.addEventListener("popstate",qa);t.addEventListener("beforeunload",pa);M(u.body);Z=!0;console.debug("init done",a)}var G=t.location,ia=u.currentScript,Ja=parseInt(I("timeout",
3E3),10),Na=parseInt(I("history",20),10),Qa=I("settle","class,style,width,height").split(","),ta=I("insert-class","ts-insert"),cb=I("remove-class","ts-remove"),Wa=I("active-class","ts-active"),Z=!1,Q=[],O={stop:function(a){a.event&&a.event.stopPropagation()},prevent:function(a){a.event&&a.event.preventDefault()},delay:function(a){return new Promise(function(b){setTimeout(b,ja(a),!0)})},not:function(a){var b=[].slice.call(arguments,1,arguments.length-1),c=H({},arguments[arguments.length-1]);c.src=
c.src.slice(c.command.length+1);b=ha(a,b,c);return null===b||void 0===b?b:!b},target:function(a,b){try{return b.el=B(b.el,a),b.el}catch(c){return!1}},remove:J(function(a){a.el.remove()},function(a,b){B(b.el,a).remove()}),wait:function(a,b){return new Promise(function(c){x(b.el,a,c,{once:!0})})},on:function(a,b){var c=b.line.split(b.src)[1].replace(/^[\s,]+/,""),d=X(c)[0];ya(b.el,a,e=>{wa(d,{el:b.el,event:e})});return!1},req:J(function(a,b){this.dispatcher(null,a,b)},function(a,b,c){V(W(c.el,c.event,
!1,{method:a,url:b,data:c.input?[["input",c.input]]:null}))}),class:function(a,b){b.el.classList.add(a)},"class+":function(a,b){b.el.classList.add(a)},"class-":function(a,b){b.el.classList.remove(a)},"class^":function(a,b){b.el.classList.toggle(a)},classtoggle:function(a,b){b.el.classList.toggle(a)},text:J(function(a){null!==a.input&&void 0!==a.input&&(a.el.innerText=a.input);return a.input},function(a,b){return b.el.innerText=a}),html:J(function(a){null!==a.input&&void 0!==a.input&&(a.el.innerHTML=
a.input);return a.el.innerHTML},function(a,b){return b.el.innerHTML=a}),attr:J(function(a,b){let c=b.el[a];return"undefined"!=typeof c?c:b.el.getAttribute(a)},function(a,b,c){c.el[a]=b;c.el.setAttribute(a,b);return b}),log:function(){var a=arguments;var b=a.length;var c=[].slice.call(a,0,b-1);a=a[b-1];a.input&&c.push(a.input);console.log.apply(console,c)}},U=console.error?console.error.bind(console,"TwinSpark error:"):console.log.bind(console,"TwinSpark error:"),H=Object.assign||function(a,b){if(!b)return a;
for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},ea=t.requestIdleCallback||function(a){setTimeout(a,100)},La=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB,ba,da=function(){function a(f,h){h.cb("node-remove",f);if(1!=f.nodeType)f.remove();else{f.classList.add(cb);h=f.getAnimations().filter(m=>m instanceof t.CSSTransition);if(!h.length)return f.remove();Promise.all(h.map(m=>m.finished)).then(()=>{f.remove()})}}function b(f,h){h.cb("node-insert",f);f instanceof HTMLElement&&
(M(f),sa(f))}function c(f,h){if(1!=f.nodeType)f.nodeValue=h.nodeValue;else{for(var m of h.attributes)C(f,h,m.name);for(m of f.attributes)C(f,h,m.name);"INPUT"==f.tagName&&"file"!=f.type?(C(f,h,"value",!0),C(f,h,"checked",!0),C(f,h,"disabled",!0)):"OPTION"==f.tagName?C(f,h,"selected"):"TEXTAREA"==f.tagName&&(C(f,h,"value"),f.firstChild&&f.firstChild.nodeValue!=h.value&&(f.firstChild.nodeValue=h.value))}}function d(f,h){const m=new Set;for(const r of h)f.has(r)&&m.add(r);return m}function e(f,h){return f&&
h&&f.nodeType==h.nodeType&&f.tagName==h.tagName}function g(f,h){if(1!=h.nodeType)return null;h=z(h,"[id]").map(m=>"#"+m.id).join(",");if(!h)return null;do if(F(f,h))return f;while(f=f.nextElementSibling);return null}function l(f,h,m){var r=h.nextSibling,D=0;do{var v=z(f,"[id]").map(E=>E.id);if(v.length&&d(m,v).size)break;if(!v.length&&!z(h,"[id]").length&&e(f,h))return f;if(e(f,r)&&(D++,r=r.nextSibling,2<=D))break}while(f=f.nextSibling);return null}function p(f,h,m){for(;f!==h;){var r=f;f=f.nextSibling;
a(r,m)}return h}function q(f,h,m){if(!m.ignoreActive||f!=u.activeElement||"INPUT"!=f.tagName&&"TEXTAREA"!=f.tagName){if(h){if(e(f,h))return c(f,h),1==f.nodeType&&1==h.nodeType&&k(f,h,m),f;f.parentElement?(f.parentElement.insertBefore(h,f.nextSibling),a(f,m),b(h,m)):f.replaceWith(h);return h}a(f,m);return null}return f}function k(f,h,m){var r=f.firstChild,D=h.firstChild;for(h=new Set(z(h,"[id]").map(db=>db.id));D;){var v=D;D=v.nextSibling;if(r){var E=g(r,v);E?(r=p(r,E,m).nextSibling,q(E,v,m)):(E=l(r,
v,h))?(r=p(r,E,m).nextSibling,q(E,v,m)):(f.insertBefore(v,r),b(v,m))}else f.appendChild(v),b(v,m)}r&&(r=p(r,f.lastChild,m),a(r,m))}function n(f,h,m={}){m.cb||(m.cb=function(){});f&&f.nodeType==Node.DOCUMENT_NODE&&(f=f.documentElement);h&&h.nodeType==Node.DOCUMENT_NODE&&(h=h.documentElement);return q(f,h,m)}n.syncAttrs=c;return n}(),N={reqs:[],request:null};L("[ts-req]",function(a){function b(c){V([W(a,c,!1)])}a.hasAttribute("ts-trigger")?x(a,"ts-trigger",b):fa(a,b)});L("[ts-req-batch]",function(a){function b(c){c=
W(a,c,!0);N.reqs.push(c);N.request||(N.request=setTimeout(Xa,16))}a.hasAttribute("ts-trigger")?x(a,"ts-trigger",b):fa(a,b)});L("[ts-action]",function(a){var b=function(c){c.detail&&c.detail.event&&(c=c.detail.event);T(B(a),c,a.getAttribute("ts-action"),null)};a.hasAttribute("ts-trigger")?x(a,"ts-trigger",b):"A"==a.tagName||"BUTTON"==a.tagName?fa(a,b):U("No trigger for action on element",a)});var ab=P(function(){return xa({on:"visible",off:"invisible",rootMargin:"0px",threshold:.01})}),bb=P(function(){return xa({on:"closeby",
off:"away",rootMargin:(t.innerHeight/2|0)+"px",threshold:.01})}),Za=P(function(){return new MutationObserver(function(a){for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.removedNodes.length;d++)w(c.removedNodes[d],"remove",{record:c})})}),$a=P(function(){return new MutationObserver(function(a){for(var b=0;b<a.length;b++){var c=a[b];"childList"==c.type&&(w(c.target,c.target.childNodes.count?"notempty":"empty",{record:c}),w(c.target,"childrenChange",{record:c}))}})});L("[ts-trigger]",function(a){var b=
a.getAttribute("ts-trigger");b&&X(b)[0].commands.forEach(function(c){var d=c.name;c=Ya(c);ya(a,d,c)})});ka(za);let Aa,Ba;(null==(Aa=t.performance)?void 0:null==(Ba=Aa.navigation)?void 0:Ba.type)==t.performance.navigation.TYPE_BACK_FORWARD&&qa({state:"INITIAL"});t[Ca]={onload:ka,register:L,activate:M,func:function(a,b){if("object"==typeof a)return H(O,a);b&&(O[a]=b);return O},elcrumbs:ma,arity:J,data:na,merge:K,target:B,query:B,trigger:w,parseAction:X,action:T,exec:ha,makeReq:W,executeReqs:V,morph:da,
setERR:a=>U=a,_internal:{DIRECTIVES:Q,FUNCS:O,init:za}}})(window,document,"twinspark");
